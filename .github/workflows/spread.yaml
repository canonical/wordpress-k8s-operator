# This is a workflow to validate the auto-generated task.yaml file

name: 'validate Spread test'

on: workflow_dispatch

jobs:
  run-spread-tests:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        spread_job: ['github-ci:ubuntu-24.04-64:tests/spread/tutorial']
    steps: 
    - name: Checkout repo
      uses: actions/checkout@v5
      with:
        fetch-depth: 0
    - name: Set up Go
      uses: actions/setup-go@v6
      with:
        go-version: 1.24
    - name: Install spread
      run: |
        go install github.com/snapcore/spread/cmd/spread@latest
    - name: Run tests
      run: |
        sudo adduser --gecos "" --disabled-password ubuntu
        echo "ubuntu:ubuntu" | sudo chpasswd
        spread ${{ matrix.spread_job }}

